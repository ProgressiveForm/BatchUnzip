# 批量解压缩工具 (Batch Decompression Tool)

一款强大的、带图形界面的批量解压缩工具，专为管理和解压大量（尤其是带密码的）压缩包而设计。

## 主要特点

- **批量处理与管理**:
  - **拖拽添加**: 支持通过拖拽文件或文件夹快速添加压缩包。
  - **列表管理**: 在左侧面板清晰地管理所有待处理的压缩包，可随时移除或安全删除。
  - **自动识别分卷**: 自动识别并处理 `.part1.rar`, `.001` 等分卷压缩包，只需添加任意一个分卷文件。
- **密码管理功能**:
  - **密码本**: 维护一个常用密码列表，可一键尝试所有密码来破解压缩包。
  - **自动记忆**: 程序会自动记住已验证成功的密码。无论是基于文件内容（哈希值）还是文件名，下次打开相同或同名文件时将自动填充密码。
- **高效的文件预览与筛选**:
  - **内容预览**: 无需解压，即可在右侧面板以目录树的形式预览所有已激活压缩包内的文件结构。
  - **聚合搜索**: 在搜索框中输入关键字，所有压缩包内的文件都会被平铺展示在一个列表中，方便快速定位文件。
  - **分类筛选**: 提供图片、视频、文档等常用文件类型的快捷筛选按钮。
- **灵活的解压与交互**:
  - **按需解压**: 在右侧文件预览区，可以自由选择任意文件或文件夹进行部分解压。
  - **双击打开**: 直接双击压缩包内的文件，程序会自动将其解压到临时目录并调用系统默认程序打开，阅后即焚。
  - **嵌套解压**: 如果压缩包内还包含其他压缩包，可以直接在文件预览区右键将其“作为压缩包添加到左侧面板”进行处理。

## 如何运行

1.  **环境准备**:
    - 确保您的系统中安装了 Python 3。
    - 本项目依赖 `7z.exe` 来执行核心解压操作，请确保 `7z.exe` 和 `7z.dll` 文件与 `main.py` 位于同一目录下。
    - 安装所需的 Python 库：
      ```bash
      pip install PyQt6 send2trash
      ```
    
2.  **启动程序**:
    
    ```bash
    python main.py
    ```

## 文件结构

- `main.py`: 主程序，包含所有UI逻辑和窗口。
- `sevenzip_handler.py`: 7-Zip 的命令行接口封装，负责执行解压、列表和测试命令。
- `password_manager.py`: 密码管理器，负责密码本和密码记忆功能的数据库读写。
- `history_manager.py`: 历史记录管理器，负责记录最近打开的压缩包路径。
- `password_db.json`: (自动生成) 存储已记忆的密码和密码本。
- `history_db.json`: (自动生成) 存储打开过的文件历史。